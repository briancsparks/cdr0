#!/usr/bin/env node

const ARGV      = require('minimist')(process.argv.slice(2));
// console.log(ARGV);

const io        = require('socket.io-client');
require('dotenv').config();

let   username  = process.env.PIPELINE_USERNAME || 'username';

const port      = process.env.PORT;
const nsSocket  = io(`http://localhost:${port}`, {query:{username}});
// console.log(nsSocket);

nsSocket.on('tellRooms', (rooms) => {
  console.log('We have been told room names: ', rooms);

  const roomToJoin = rooms.nsRooms[0].roomTitle;
  nsSocket.emit('joinRoom', roomToJoin, (err, numClients) => {
    console.log(`joined ${roomToJoin}`, numClients);

    currRoomName = roomToJoin;
    // roomsJoined[roomToJoin] = nsRooms[0];
  });
});


nsSocket.on('msgFromRoom', (msg) => {
  console.log(msg);
});



